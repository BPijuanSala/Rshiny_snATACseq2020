scale_color_manual(values = unname(all_colours_sub[order(names(all_colours_sub))]),
labels = names(all_colours_sub)[order(names(all_colours_sub))],
drop = FALSE, name = "")  +
theme_void() +
theme(legend.text=element_text(size=rel(1.5))) +
guides(colour = guide_legend(override.aes = list(size=7))) + ggtitle("")
print(plot)
ggsave(filename=paste0(wd,"PhD_BPS53/plots/revision1/UMAP_AL_EC_HAEM_celltypes_website.png"),
plot=plot,width = 7, height = 6,
device="png")
p = ggplot(meta_endo, aes(x=umap_X, y=umap_Y))
plot = p + geom_point(aes(col = factor(meta_endo$al_haem_endo_clusters))) +
scale_color_manual(values = unname(clust_endo_colours[order(names(clust_endo_colours))]),
labels = names(clust_endo_colours)[order(names(clust_endo_colours))],
drop = FALSE, name = "")  +
theme_void() +
theme(legend.text=element_text(size=rel(1.5))) +
guides(colour = guide_legend(override.aes = list(size=7))) + ggtitle("")
print(plot)
ggsave(filename=paste0(wd,"PhD_BPS53/plots/revision1/UMAP_AL_EC_HAEM_website.png"),
plot=plot,width = 7, height = 6,
device="png")
wd <- "/Users/blancap/Documents/PhD_CAMBRIDGE/PhD/Experiments/"
#***************************************************************************
##===========================
# ALTERNATIVE to code above to annotate marker regions more refined
# This uses a variable "peakGene" generated in the code below.
##===========================
load(file=paste0(wd,"PhD_BPS53/data/revision1/10_peaks_all/peakGene.rda"))
peakGene[as.character(peakGene$distance_from_TSS) =="TSS" ,"Annotation.General"] = "TSS"
peakGene[peakGene$accessibility_ratio>0.25  ,"celltype_specificity"] = "Ubiquitous"
peakGene_uniq = peakGene[!duplicated(peakGene[,c('peakID')]),]
rownames(peakGene_uniq)=peakGene_uniq$peakID
shiny::runApp('Documents/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS39/scripts/website3')
runApp('Documents/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS32/release6/shiny/EmbryoTimecourseShiny')
load(paste0(wd,"PhD_BPS53/data/revision1/10_peaks_all/peakGene_refined.rda"))
wd <- "/Users/blancap/Documents/PhD_CAMBRIDGE/PhD/Experiments/"
load(paste0(wd,"PhD_BPS53/data/revision1/10_peaks_all/peakGene_refined.rda"))
peakGene[peakGene$distance_from_TSS %in% c("TSS","gene"), ]
library(HDF5Array)
sessionInfo()
204+168+30
profvis({shiny::runApp("/Users/blancap/Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split")})
library(profvis)
profvis({shiny::runApp("/Users/blancap/Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split")})
library(profvis)
profvis({shiny::runApp("/Users/blancap/Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split")})
library(profvis)
profvis({shiny::runApp("/Users/blancap/Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split")})
shiny::runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split_TESTS')
library(profvis)
profvis({shiny::runApp("/Users/blancap/Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split_TEST")})
profvis({shiny::runApp("/Users/blancap/Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split_TESTS")})
profvis({shiny::runApp("/Users/blancap/Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split_TESTS")})
x = meta$umap_X
y=meta$umap_Y
input=list()
input$TF = "GATA1"
value=as.numeric(link_chromVAR[match(as.character(input$TF),
as.character((TFs_chromVAR_abbrev_up))),])
gene = value
cols=c("#BFBFBF",#mid
"#de1404",#high
"#0664cf")
xlab=""
ylab=""
label_legend=expression('log'[10]*' normalized counts + 1')
titlePlot=gene
cexType=1
ybsub=0.1
redRamp <- colorRampPalette(cols[1,2])
blueRamp <- colorRampPalette(cols[1,3])
cols[1,2]
cols=c("#BFBFBF",#mid
"#de1404",#high
"#0664cf")
cols[1,2]
cols
redRamp <- colorRampPalette(cols[c(1,2)])
blueRamp <- colorRampPalette(cols[c(1,3)])
df <- data.frame(x = x, y = y, exp = gene)
df <- df[order(df$exp,decreasing=F),]
dfsub <- df[df$exp>0,]
num_fragments = 20
interval <- findInterval(df$exp, seq(min(df$exp),
max(df$exp),
(max(df$exp)-min(df$exp))/num_fragments))
interval
length(interval)
interval[1:2,]
interval[1:2]
interval <- findInterval(df$exp, seq(min(df$exp),
max(df$exp),
(max(df$exp)-min(df$exp))/num_fragments))
interval[1:2]
which(interval==0)
interval[interval==0]<-1
redRamp((num_fragments+1))
unique(interval)
redRamp <- colorRampPalette(cols[c(1,2)])
blueRamp <- colorRampPalette(cols[c(1,3)])
df <- data.frame(x = x, y = y, exp = gene)
df <- df[order(df$exp,decreasing=F),]
dfsub <- df[df$exp>=0,]
num_fragments = 20
interval <- findInterval(dfsub$exp, seq(min(dfsub$exp),
max(dfsub$exp),
(max(dfsub$exp)-min(dfsub$exp))/num_fragments))
interval[interval==0]<-1
colorsPlot <- redRamp((num_fragments+1))[interval]
df$cols = rep(0,nrow(df))
df[df$exp>=0,"cols"] = colorsPlot
dfsub <- df[df$exp<=0,]
num_fragments = 20
dfsub$exp <- abs(dfsub$exp)
num_fragments = 20
interval <- findInterval(dfsub$exp, seq(min(dfsub$exp),
max(dfsub$exp),
(max(dfsub$exp)-min(dfsub$exp))/num_fragments))
interval[interval==0]<-1
colorsPlot <- blueRamp((num_fragments+1))[interval]
which(df$cols=="0")
length(which(df$cols=="0"))
dfsub <- df[df$exp<=0,]
dfsub$exp <- abs(dfsub$exp)
num_fragments = 20
interval <- findInterval(dfsub$exp, seq(min(dfsub$exp),
max(dfsub$exp),
(max(dfsub$exp)-min(dfsub$exp))/num_fragments))
interval[interval==0]<-1
colorsPlot <- blueRamp((num_fragments+1))[interval]
df[df$exp<=0,"cols"] = colorsPlot
length(which(df$cols=="0"))
plot(df$x, df$y, col=as.character(df$cols), pch=20, cex=cexType,
xlab="", ylab="", main=titlePlot, axes=F, cex.main=1.5)
as.character(df$cols)
redRamp <- colorRampPalette(cols[c(1,2)])
blueRamp <- colorRampPalette(cols[c(1,3)])
df <- data.frame(x = x, y = y, exp = gene)
df <- df[order(df$exp,decreasing=F),]
dfsub <- df[df$exp>=0,]
num_fragments = 20
interval <- findInterval(dfsub$exp, seq(min(dfsub$exp),
max(dfsub$exp),
(max(dfsub$exp)-min(dfsub$exp))/num_fragments))
interval[interval==0]<-1
colorsPlot <- redRamp((num_fragments+1))[interval]
df$cols = rep(0,nrow(df))
colorsPlot
df[df$exp>=0,"cols"] = as.character(colorsPlot)
length(as.character(colorsPlot))
length(which(df$exp>=0))
tail(df$exp>=0)
tail(colorsPlot)
head(colorsPlot)
df[df$exp>=0,"cols"] = as.character(colorsPlot)
dfsub <- df[df$exp<=0,]
dfsub$exp <- abs(dfsub$exp)
num_fragments = 20
interval <- findInterval(dfsub$exp, seq(min(dfsub$exp),
max(dfsub$exp),
(max(dfsub$exp)-min(dfsub$exp))/num_fragments))
interval[interval==0]<-1
colorsPlot <- blueRamp((num_fragments+1))[interval]
df[df$exp<=0,"cols"] = as.character(colorsPlot)
df$cols
head(df)
head(df$cols)
tail(df$cols)
df[df$exp<=0,"cols"] = as.character(colorsPlot)
df <- df[order(abs(df$exp),decreasing=F),]
#bottom, left, top and right
par(mar=c(8,3,4,3),xpd=NA)
plot(df$x, df$y, col=as.character(df$cols), pch=20, cex=cexType,
xlab="", ylab="", main=titlePlot, axes=F, cex.main=1.5)
titlePlot
gene
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split_TESTS')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split_TESTS')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split_TESTS')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split_TESTS')
length(unique(as.character(df$cols)))
length(head(seq(xl,xr,(xr-xl)/num_fragments),-1))
head(seq(xl,xr,(xr-xl)/num_fragments),-1)
df <- df[order((df$exp),decreasing=F),]
num_fragments=num_fragments*2
xl <- min(df$x)- (min(df$x)*(-5.57*10^(-4)))
yb <- (min(df$y))-(-0.17*min(df$y))
xr <- max(df$x)
yt <- (min(df$y))-(min(df$y)*(-0.07))
head(seq(xl,xr,(xr-xl)/num_fragments),-1)
length(head(seq(xl,xr,(xr-xl)/num_fragments),-1))
length(tail(seq(xl,xr,(xr-xl)/num_fragments),-1))
rect(xleft=head(seq(xl,xr,(xr-xl)/num_fragments),-1), ybottom = yb,
xright = tail(seq(xl,xr,(xr-xl)/num_fragments),-1), ytop = yt,
col=unique(as.character(df$cols)), border=unique(as.character(df$cols)), lwd=0.5, xpd=NA)
rect(xl,yb,xr,yt, xpd=NA)
segments(seq(xl,xr,((xr-xl)/5)),yb,seq(xl,xr,((xr-xl)/5)),yb-(-yb*0.0381), xpd=NA)
text(seq(xl,xr,((xr-xl)/5)), yb-(-yb*0.089), labels = round(seq(min(df$exp), max(df$exp), (max(df$exp)-min(df$exp))/5),3), cex=1, xpd=NA)
text(stats::median(seq(xl,xr,((xr-xl)/5))), yb-(-yb*0.216), labels = label_legend,cex=1.2, xpd=NA)
titlePlot=""
#bottom, left, top and right
par(mar=c(8,3,4,3),xpd=NA)
plot(df$x, df$y, col=as.character(df$cols), pch=20, cex=cexType,
xlab="", ylab="", main=titlePlot, axes=F, cex.main=1.5)
df <- df[order((df$exp),decreasing=F),]
df <- df[order(abs(df$exp),decreasing=F),]
#bottom, left, top and right
par(mar=c(8,3,4,3),xpd=NA)
plot(df$x, df$y, col=as.character(df$cols), pch=20, cex=cexType,
xlab="", ylab="", main=titlePlot, axes=F, cex.main=1.5)
df <- df[order((df$exp),decreasing=F),]
num_fragments=num_fragments*2
xl <- min(df$x)- (min(df$x)*(-5.57*10^(-4)))
yb <- (min(df$y))-(-0.17*min(df$y))
xr <- max(df$x)
yt <- (min(df$y))-(min(df$y)*(-0.07))
rect(xleft=head(seq(xl,xr,(xr-xl)/num_fragments),-1), ybottom = yb,
xright = tail(seq(xl,xr,(xr-xl)/num_fragments),-1), ytop = yt,
col=unique(as.character(df$cols)), border=unique(as.character(df$cols)), lwd=0.5, xpd=NA)
plot(df$x, df$y, col=as.character(df$cols), pch=20, cex=cexType,
xlab="", ylab="", main=titlePlot, axes=F, cex.main=1.5)
df <- df[order((df$exp),decreasing=F),]
num_fragments=num_fragments*2
xl <- min(df$x)- (min(df$x)*(-5.57*10^(-4)))
yb <- (min(df$y))-(-0.17*min(df$y))
xr <- max(df$x)
yt <- (min(df$y))-(min(df$y)*(-0.07))
rect(xleft=head(seq(xl,xr,(xr-xl)/num_fragments),-1), ybottom = yb,
xright = tail(seq(xl,xr,(xr-xl)/num_fragments),-1), ytop = yt,
col=unique(as.character(df$cols)), border=unique(as.character(df$cols)), lwd=0.5, xpd=NA)
#bottom, left, top and right
par(mar=c(8,3,4,3),xpd=NA)
plot(df$x, df$y, col=as.character(df$cols), pch=20, cex=cexType,
xlab="", ylab="", main=titlePlot, axes=F, cex.main=1.5)
df <- df[order((df$exp),decreasing=F),]
num_fragments=num_fragments*2
xl <- min(df$x)- (min(df$x)*(-5.57*10^(-4)))
yb <- (min(df$y))-(-0.17*min(df$y))
xr <- max(df$x)
yt <- (min(df$y))-(min(df$y)*(-0.07))
df <- df[order(abs(df$exp),decreasing=F),]
#bottom, left, top and right
par(mar=c(8,3,4,3),xpd=NA)
plot(df$x, df$y, col=as.character(df$cols), pch=20, cex=cexType,
xlab="", ylab="", main=titlePlot, axes=F, cex.main=1.5)
df <- df[order((df$exp),decreasing=F),]
num_fragments=num_fragments*2
xl <- min(df$x)- (min(df$x)*(-5.57*10^(-4)))
yb <- (min(df$y))-(-0.17*min(df$y))
xr <- max(df$x)
yt <- (min(df$y))-(min(df$y)*(-0.07))
rect(xleft=head(seq(xl,xr,(xr-xl)/num_fragments),-1), ybottom = yb,
xright = tail(seq(xl,xr,(xr-xl)/num_fragments),-1), ytop = yt,
col=unique(as.character(df$cols)), border=unique(as.character(df$cols)), lwd=0.5, xpd=NA)
num_fragments
redRamp <- colorRampPalette(cols[c(1,2)])
blueRamp <- colorRampPalette(cols[c(1,3)])
df <- data.frame(x = x, y = y, exp = gene)
df <- df[order(df$exp,decreasing=F),]
dfsub <- df[df$exp>=0,]
num_fragments = 20
interval <- findInterval(dfsub$exp, seq(min(dfsub$exp),
max(dfsub$exp),
(max(dfsub$exp)-min(dfsub$exp))/num_fragments))
interval[interval==0]<-1
colorsPlot <- redRamp((num_fragments+1))[interval]
df$cols = rep(0,nrow(df))
df[df$exp>=0,"cols"] = as.character(colorsPlot)
df <- df[order(df$exp,decreasing=T),]
dfsub <- df[df$exp<=0,]
dfsub$exp <- abs(dfsub$exp)
num_fragments = 20
interval <- findInterval(dfsub$exp, seq(min(dfsub$exp),
max(dfsub$exp),
(max(dfsub$exp)-min(dfsub$exp))/num_fragments))
interval[interval==0]<-1
colorsPlot <- blueRamp((num_fragments+1))[interval]
df[df$exp<=0,"cols"] = as.character(colorsPlot)
df <- df[order(abs(df$exp),decreasing=F),]
#bottom, left, top and right
par(mar=c(8,3,4,3),xpd=NA)
plot(df$x, df$y, col=as.character(df$cols), pch=20, cex=cexType,
xlab="", ylab="", main=titlePlot, axes=F, cex.main=1.5)
df <- df[order((df$exp),decreasing=F),]
num_fragments=num_fragments*2
xl <- min(df$x)- (min(df$x)*(-5.57*10^(-4)))
yb <- (min(df$y))-(-0.17*min(df$y))
xr <- max(df$x)
yt <- (min(df$y))-(min(df$y)*(-0.07))
rect(xleft=head(seq(xl,xr,(xr-xl)/num_fragments),-1), ybottom = yb,
xright = tail(seq(xl,xr,(xr-xl)/num_fragments),-1), ytop = yt,
col=unique(as.character(df$cols)), border=unique(as.character(df$cols)), lwd=0.5, xpd=NA)
rect(xl,yb,xr,yt, xpd=NA)
segments(seq(xl,xr,((xr-xl)/5)),yb,seq(xl,xr,((xr-xl)/5)),yb-(-yb*0.0381), xpd=NA)
text(seq(xl,xr,((xr-xl)/5)), yb-(-yb*0.089), labels = round(seq(min(df$exp), max(df$exp), (max(df$exp)-min(df$exp))/5),3), cex=1, xpd=NA)
text(stats::median(seq(xl,xr,((xr-xl)/5))), yb-(-yb*0.216), labels = label_legend,cex=1.2, xpd=NA)
df <- df[order(df$exp,decreasing=T),]
absolute = max(abs(df$exp))
dfsub <- df[df$exp<=0,]
dfsub$exp <- abs(dfsub$exp)
num_fragments = 20
interval <- findInterval(dfsub$exp, seq(0,
absolute,
(absolute-0)/num_fragments))
interval
num_fragments
blueRamp
num_fragments+1
absolute
interval
length(interval)
dfsub$exp
seq(0,
absolute,
(absolute-0)/num_fragments)
redRamp <- colorRampPalette(cols[c(1,2)])
blueRamp <- colorRampPalette(cols[c(1,3)])
df <- data.frame(x = x, y = y, exp = gene)
df <- df[order(df$exp,decreasing=F),]
absolute = max(abs(df$exp))
dfsub <- df[df$exp>=0,]
num_fragments = 20
interval <- findInterval(dfsub$exp, seq(0,
absolute,
(absolute-0)/num_fragments))
interval[interval==0]<-1
colorsPlot <- redRamp((num_fragments+1))[interval]
df$cols = rep(0,nrow(df))
df[df$exp>=0,"cols"] = as.character(colorsPlot)
df <- df[order(df$exp,decreasing=T),]
dfsub <- df[df$exp<=0,]
dfsub$exp <- abs(dfsub$exp)
num_fragments = 20
interval <- findInterval(dfsub$exp, seq(0,
absolute,
(absolute-0)/num_fragments))
interval[interval==0]<-1
colorsPlot <- blueRamp((num_fragments+1))[interval]
df[df$exp<=0,"cols"] = as.character(colorsPlot)
df <- df[order(abs(df$exp),decreasing=F),]
#bottom, left, top and right
par(mar=c(8,3,4,3),xpd=NA)
plot(df$x, df$y, col=as.character(df$cols), pch=20, cex=cexType,
xlab="", ylab="", main=titlePlot, axes=F, cex.main=1.5)
df <- df[order((df$exp),decreasing=F),]
num_fragments=num_fragments*2
xl <- min(df$x)- (min(df$x)*(-5.57*10^(-4)))
yb <- (min(df$y))-(-0.17*min(df$y))
xr <- max(df$x)
yt <- (min(df$y))-(min(df$y)*(-0.07))
rect(xleft=head(seq(xl,xr,(xr-xl)/num_fragments),-1), ybottom = yb,
xright = tail(seq(xl,xr,(xr-xl)/num_fragments),-1), ytop = yt,
col=unique(as.character(df$cols)), border=unique(as.character(df$cols)), lwd=0.5, xpd=NA)
num_fragments
length(head(seq(xl,xr,(xr-xl)/num_fragments),-1))
length(unique(as.character(df$cols)))
seq(xl,xr,(xr-xl)
)
seq(xl,xr,(xr-xl)/num_fragments)
#bottom, left, top and right
par(mar=c(8,3,4,3),xpd=NA)
plot(df$x, df$y, col=as.character(df$cols), pch=20, cex=cexType,
xlab="", ylab="", main=titlePlot, axes=F, cex.main=1.5)
df <- df[order((df$exp),decreasing=F),]
num_sec=length(unique(as.character(df$cols)))
xl <- min(df$x)- (min(df$x)*(-5.57*10^(-4)))
yb <- (min(df$y))-(-0.17*min(df$y))
xr <- max(df$x)
yt <- (min(df$y))-(min(df$y)*(-0.07))
rect(xleft=head(seq(xl,xr,(xr-xl)/num_sec),-1), ybottom = yb,
xright = tail(seq(xl,xr,(xr-xl)/num_sec),-1), ytop = yt,
col=unique(as.character(df$cols)), border=unique(as.character(df$cols)), lwd=0.5, xpd=NA)
rect(xl,yb,xr,yt, xpd=NA)
segments(seq(xl,xr,((xr-xl)/5)),yb,seq(xl,xr,((xr-xl)/5)),yb-(-yb*0.0381), xpd=NA)
text(seq(xl,xr,((xr-xl)/5)), yb-(-yb*0.089), labels = round(seq(min(df$exp), max(df$exp), (max(df$exp)-min(df$exp))/5),3), cex=1, xpd=NA)
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split_TESTS')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split_TESTS')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split_TESTS')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split_TESTS')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split_TESTS')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split_TESTS')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split_TESTS')
profvis({shiny::runApp("/Users/blancap/Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split_TESTS")})
shiny::runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
shiny::runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
library(profvis)
profvis({shiny::runApp("/Users/blancap/Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split_TESTS")})
shiny::runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
??recordPlot
recordPlot
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
input=list()
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
profvis({shiny::runApp("/Users/blancap/Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split_TESTS")})
library(profvis)
profvis({shiny::runApp("/Users/blancap/Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split_TESTS")})
profvis({shiny::runApp("/Users/blancap/Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split_TESTS")})
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
shiny::runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
shiny::runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
runApp('Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split')
setwd("/Users/blancap/Documents/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split/")
genomic_regions <- as.data.frame(feather::read_feather("./www/data/genomic_regions.feather"))
setwd("/Users/blancap/Documents/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split/")
###########
setwd("/Users/blancap/Documents/CAREER/PhD_CAMBRIDGE/PhD/Experiments/PhD_BPS53/scripts/website_production/chromatin_early_organogenesis_split/")
library(feather)
load("./www/data/genomic_regions.RData")
paste0("chr",genomic_regions$peak_chr,"_",genomic_regions$peak_start,"_",genomic_regions$peak_end)
[1:2]
paste0("chr",genomic_regions$peak_chr,"_",genomic_regions$peak_start,"_",genomic_regions$peak_end)[1:2]
genomic_regions$peakID = paste0("chr",genomic_regions$peak_chr,"_",genomic_regions$peak_start,"_",genomic_regions$peak_end)
dim(genomic_regions)
colnames(genomic_regions[,c(12,1:11)])
genomic_regions[,c(12,1:11)]
load("./www/data/genomic_regions.RData")
library(feather)
genomic_regions$peakID = paste0("chr",genomic_regions$peak_chr,"_",genomic_regions$peak_start,"_",genomic_regions$peak_end)
genomic_regions = genomic_regions[,c(12,1:11)]
path <- "./www/data/genomic_regions.feather"
write_feather(genomic_regions, path)
shiny::runApp()
colnames(genomic_regions)
runApp()
